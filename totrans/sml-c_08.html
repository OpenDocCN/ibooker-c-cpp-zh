<html><head></head><body><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 8. Real-World C With Arduino"><div class="chapter" id="smallerc-CHP-8">
<h1><span class="label">Chapter 8. </span>Real-World C With Arduino</h1>


<p>We’ve seen our C skills grow from compiling a short list of simple statements to passing pointers to functions with nested flow of control. But so far we’ve been printing results in our terminal windows. That’s great for proving that our logic works and that our program is doing what we expect, but eventually we’ll want code that runs somewhere other than a terminal in order to take advantage of all the great hardware out there. In the rest of this book, we’re going to write code aimed at microcontrollers. And what better microcontroller to start with than an Arduino.</p>

<p>The <a data-type="indexterm" data-primary="Arduino microcontrollers" id="idm45018720332408"/>Arduino family of microcontrollers has been around for over 15 years. Starting with <a href="https://oreil.ly/EH7un">8-bit Atmel AVR</a> controllers designed specifically to facilitate learning and tinkering,
these gadgets have exploded in popularity. These days, you can find a wealth of
development boards preloaded with all manner of sensors and connections. WiFi,
GPS, Bluetooth, even radio options can be added easily. The ecosystem of inputs, outputs, and containers is truly mind-boggling. For us, that makes this platform a perfect target. You can grab an inexpensive controller and LEDs to start, and expand into robotics or weather stations or radio control or
just about any other electronics niche that tickles your fancy.<sup><a data-type="noteref" id="idm45018720330312-marker" href="ch08.xhtml#idm45018720330312">1</a></sup></p>

<p><a data-type="xref" href="app01.xhtml#smallerc-APP-A-SECT-2">“Getting the Hardware: Adafruit”</a> includes information on all the microcontrollers and
peripherals I’ll be using throughout the rest of the book. But any Arduino-compatible
microcontroller will work with the majority of our examples.</p>






<section data-type="sect1" data-pdf-bookmark="Arduino IDE (Win, Mac, Linux)"><div class="sect1" id="smallerc-CHP-8-SECT-1">
<h1>Arduino IDE (Win, Mac, Linux)</h1>

<p>Way back in <a data-type="xref" href="ch01.xhtml#smallerc-CHP-1-SECT-2.3">“Compiling Your Code”</a>, we learned how to compile C source code
into an executable for our operating system on our machine. And while it might be
possible to run a C compiler on an Arduino controller, we can use the notion of
a <em>cross-compiler</em> to<a data-type="indexterm" data-primary="cross-compilers" id="idm45018720322776"/> let our fancy laptops and desktops do the hard work of
compiling, yet still produce a binary built for Arduino.</p>

<p>You can find tools like <code>gcc-avr</code> to run from the command line as we did with
<code>gcc</code>, but fortunately there is a nifty IDE that does what it says on the label.
The <a data-type="indexterm" data-primary="Arduino IDE" data-secondary="purpose of" id="idm45018720320568"/>Arduino IDE is an integrated development environment where you can edit your
source code, compile it, load to a microcontroller, and watch a serial console for help
debugging. See an error in that console? Fix the source, recompile, and reload.
And it runs on all three major platforms.</p>

<p>No matter <a data-type="indexterm" data-primary="Arduino IDE" data-secondary="downloading" id="idm45018720318776"/><a data-type="indexterm" data-primary="downloading" data-secondary="Arduino IDE" id="idm45018720317768"/>your platform, head to the <a href="https://oreil.ly/jMXH0">Arduino Software</a>
page (see <a data-type="xref" href="#smallerc-CHP-8-FIG-arduino-download">Figure 8-1</a>) and download the appropriate version.
If you want background on the features of the IDE, you can look over the
<a href="https://oreil.ly/FKreY">IDE Environment Guide</a> online.</p>

<figure><div id="smallerc-CHP-8-FIG-arduino-download" class="figure">
<img src="Images/smac_0801.png" alt="smac 0801" width="1179" height="576"/>
<h6><span class="label">Figure 8-1. </span>The Arduino IDE download site</h6>
</div></figure>

<p>Let’s take a look at the installation details for Windows, macOS, and Linux.
Mostly the Arudino IDE is a mature tool with a typical installer, but there are a
few platform-specific steps and gotchas I want to point out.</p>








<section data-type="sect2" class="pagebreak-before less_space" data-pdf-bookmark="Installing on Windows"><div class="sect2" id="smallerc-CHP-8-SECT-1.1">
<h2>Installing on Windows</h2>

<p>From<a data-type="indexterm" data-primary="Arduino IDE" data-secondary="installing" data-tertiary="on Windows" data-tertiary-sortas="Windows" id="ardIDE-install-windows"/><a data-type="indexterm" data-primary="installing" data-secondary="Arduino IDE" data-tertiary="on Windows" data-tertiary-sortas="Windows" id="install-ardIDE-windows"/><a data-type="indexterm" data-primary="Windows" data-secondary="Arduino IDE, installing" id="windows-ardIDE-install"/> the download page, be sure to grab one of the downloads that come direct from
arduino.cc, either the ZIP file or the Windows 7 and up installer.</p>
<div data-type="warning" epub:type="warning"><h6>Warning</h6>
<p>If you use the Microsoft Store for apps, you may have noticed the Arduino IDE
there as well. Regrettably, there are many reports of difficulties using this
version of the IDE. It is older, and the store listing does not seem to be
well maintained. We recommend avoiding this version, even though a link to the
store is available on the downloads page.</p>
</div>

<p>The <a href="https://oreil.ly/Fa8kZ">online guide</a> has detailed instructions for installing the Arduino IDE through the <em>.exe</em> file you downloaded. It’s a fairly standard Windows installer; our only suggestion is to install all of the components available when prompted. (If you don’t want shortcuts on your desktop or in your start menu, you can certainly uncheck those.) You may also be prompted to install some ports and drivers, which we recommend using as well. If all goes well, you can launch the IDE and see an empty document, as shown in <a data-type="xref" href="#smallerc-CHP-8-FIG-win10-ide-launch">Figure 8-2</a>.</p>

<figure><div id="smallerc-CHP-8-FIG-win10-ide-launch" class="figure">
<img src="Images/smac_0802.png" alt="smac 0802" width="2131" height="1322"/>
<h6><span class="label">Figure 8-2. </span>The Arduino IDE running on Windows 10</h6>
</div></figure>

<p>Once your IDE is running, go ahead and try the first project in <a data-type="xref" href="#smallerc-CHP-8-SECT-2">“Your First Arduino Project”</a>.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Installing on macOS"><div class="sect2" id="smallerc-CHP-8-SECT-1.2">
<h2>Installing on macOS</h2>

<p>The<a data-type="indexterm" data-primary="Arduino IDE" data-secondary="installing" data-tertiary="on macOS" data-tertiary-sortas="macOS" id="ardIDE-install-macOS"/><a data-type="indexterm" data-primary="installing" data-secondary="Arduino IDE" data-tertiary="on macOS" data-tertiary-sortas="macOS" id="install-ardIDE-macOS"/><a data-type="indexterm" data-primary="macOS" data-secondary="Arduino IDE, installing" id="macOS-ardIDE-install"/> macOS version of Arduino IDE is delivered as a simple <em>.zip</em> file. Many browsers
will automatically unzip the download, but you can always double-click the file
yourself to unzip. The only thing in the <em>.zip</em> file is the macOS application. Go
ahead and drag the application to your <em>Applications</em> folder. (This may require you
to enter your administrative password.) That’s it! If it worked, you should see
the standard startup in <a data-type="xref" href="#smallerc-CHP-8-FIG-mac-ide-launch">Figure 8-3</a>.</p>

<figure><div id="smallerc-CHP-8-FIG-mac-ide-launch" class="figure">
<img src="Images/smac_0803.png" alt="smac 0803" width="1332" height="846"/>
<h6><span class="label">Figure 8-3. </span>The Arduino IDE running on macOS</h6>
</div></figure>

<p>Once your IDE is running, go ahead and try the first project in <a data-type="xref" href="#smallerc-CHP-8-SECT-2">“Your First Arduino Project”</a>.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Installing on Linux"><div class="sect2" id="smallerc-CHP-8-SECT-1.3">
<h2>Installing on Linux</h2>

<p>For<a data-type="indexterm" data-primary="Arduino IDE" data-secondary="installing" data-tertiary="on Linux" data-tertiary-sortas="Linux" id="ardIDE-install-Linux"/><a data-type="indexterm" data-primary="installing" data-secondary="Arduino IDE" data-tertiary="on Linux" data-tertiary-sortas="Linux" id="install-ardIDE-Linux"/><a data-type="indexterm" data-primary="Linux" data-secondary="Arduino IDE, installing" id="Linux-ardIDE-install"/> Linux, you also receive the application as a simple archive, <em>.tar.xz</em> in this
case. Most distributions have an archive manager app that will happily unpack your
download with a double-click. If you don’t have such an accommodating app already,
you can try your version of <code>tar</code> as it can automatically decompress most types of archives:</p>

<pre data-type="programlisting">$ tar xf arduino-1.8.13-linux64.tar.xz</pre>

<p>(Of course your filename may be different depending on your platform and the
currently released version of the app itself.)</p>

<p>Place the unpacked folder (named <em>arduino-1.8.13</em>, again, depending on the version
you downloaded) wherever you want to keep the application. That might be
in a shared location or just in your own user directory somewhere. Once you have it
in your preferred spot, change into that <em>arduino-1.8.13</em> folder and run <strong><code>./install.sh</code></strong>.
That script will do its best to add shortcuts to your start menu and desktop. Go ahead
and start the app to make sure the installation worked. You should end up with something
like <a data-type="xref" href="#smallerc-CHP-8-FIG-linux-ide-launch">Figure 8-4</a>, similar to that for the other operating systems.</p>

<figure><div id="smallerc-CHP-8-FIG-linux-ide-launch" class="figure">
<img src="Images/smac_0804.png" alt="smac 0804" width="1206" height="776"/>
<h6><span class="label">Figure 8-4. </span>The Arduino IDE running on Linux (with Gnome)</h6>
</div></figure>

<p>Hooray! Let’s get that first program running on<a data-type="indexterm" data-primary="Arduino IDE" data-secondary="installing" data-tertiary="on Linux" data-tertiary-sortas="Linux" data-startref="ardIDE-install-Linux" id="idm45018720224648"/><a data-type="indexterm" data-primary="installing" data-secondary="Arduino IDE" data-tertiary="on Linux" data-tertiary-sortas="Linux" data-startref="install-ardIDE-Linux" id="idm45018720222856"/><a data-type="indexterm" data-primary="Linux" data-secondary="Arduino IDE, installing" data-startref="Linux-ardIDE-install" id="idm45018720221096"/> our microcontroller.</p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Your First Arduino Project"><div class="sect1" id="smallerc-CHP-8-SECT-2">
<h1>Your First Arduino Project</h1>

<p>Of course, with microcontrollers like Arduino, the IDE is only half of the equation. You
need an actual Arduino controller! Or at least one of its many siblings. You can get
these boards from a wide variety of sellers and manufacturers. I’ll toss out an
unpaid plug<a data-type="indexterm" data-primary="Adafruit" id="idm45018720217816"/> for <a href="https://adafruit.com">Adafruit</a> as they have a fantastic array of
both boards and peripherals—plus everything else that goes into building actual
electronics projects. Their Trinkets and Feathers and ultra dimunitive QT Py pack some
great features in some small packages.</p>








<section data-type="sect2" data-pdf-bookmark="Selecting Your Board"><div class="sect2" id="smallerc-CHP-8-SECT-2.1">
<h2>Selecting Your Board</h2>

<p>Whatever <a data-type="indexterm" data-primary="Arduino microcontrollers" data-secondary="selecting in IDE" id="ardmicro-selecting"/><a data-type="indexterm" data-primary="Arduino IDE" data-secondary="selecting microcontrollers in" id="ardIDE-select"/><a data-type="indexterm" data-primary="selecting microcontrollers in IDE" id="select-microcontroller"/><a data-type="indexterm" data-primary="microcontrollers" data-seealso="Arduino microcontrollers" id="idm45018720210600"/><a data-type="indexterm" data-primary="boards" data-see="Arduino microcontrollers" id="idm45018720209640"/>microcontroller you choose, you’ll need to specify that choice in the
Arduino IDE. Under the Tools menu, look for the Board: item. Then comes
a long, long list of supported boards ready for you to use, as shown in <a data-type="xref" href="#smallerc-CHP-8-FIG-ide-boards">Figure 8-5</a>.
You can see that I have the “Adafruit ESP32 Feather” board selected.
That’s just
the most recent project I was tackling—an ESP32 WiFi-enabled LED project.
It really is amazing what fits on a microcontroller
these days! If you don’t see a matching board in this list, go back to the top
for the “Boards Manager…” option. That option opens a dialog where you can
browse for other supported boards.</p>

<figure><div id="smallerc-CHP-8-FIG-ide-boards" class="figure">
<img src="Images/smac_0805.png" alt="smac 0805" width="1441" height="487"/>
<h6><span class="label">Figure 8-5. </span>Supported development boards</h6>
</div></figure>

<p>For most of the examples in this book, I’ll be using a
<a href="https://oreil.ly/6oe6O">Metro Mini from Adafruit</a>, as shown in
<a data-type="xref" href="#smallerc-CHP-8-FIG-metro-mini">Figure 8-6</a>. It
has a 16MHz ATmega328P with 2K of RAM and 32K of flash. With lots of I/O pins, we’ll
be free to tackle a good range of interesting projects getting input from sensors and
switches while providing output through LEDs, LCDs, and servos.</p>

<figure class="width-70"><div id="smallerc-CHP-8-FIG-metro-mini" class="figure">
<img src="Images/smac_0806.png" alt="smac 0806" width="2328" height="1431"/>
<h6><span class="label">Figure 8-6. </span>The Metro Mini microcontroller from Adafruit</h6>
</div></figure>

<p>The Metro Mini is pin-compatible
with the Arduino UNO, so let’s select that as our board option. <a data-type="xref" href="#smallerc-CHP-8-FIG-select-uno">Figure 8-7</a> shows
the Boards list again with our UNO selected. A <em>pin</em>, by<a data-type="indexterm" data-primary="pins" id="idm45018720198616"/> the way, is what you call the things that
stick out of the microcontroller and fit into your breadboard (engineer-speak for the nifty, perforated base
that simplifies connecting components). Even when you connect your Arduino
using something else like alligator clips or just soldering a wire directly, “pin” is still the
term for a named or numbered connection to the microcontroller. <a data-type="indexterm" data-primary="pin-out diagrams" id="idm45018720197352"/>A “pin-out diagram” is
a sort of cheat sheet for matching up those names and numbers to actual connecting points on the
device.</p>

<figure><div id="smallerc-CHP-8-FIG-select-uno" class="figure">
<img src="Images/smac_0807.png" alt="smac 0807" width="1078" height="692"/>
<h6><span class="label">Figure 8-7. </span>Selecting the UNO board</h6>
</div></figure>
<div data-type="tip"><h6>Tip</h6>
<p>Chances are pretty high that you’ll have a different microcontroller. There are so many wonderful options out there for makers and anyone else tinkering with electronics. Hopefully, you see your board in the list and can simply select it like we did with the UNO. Sadly, we can’t cover every option or even predict the most popular ones. The <a href="https://oreil.ly/bgyMM">Arduino Help Center</a> has some great documentation and FAQs. Their community<a data-type="indexterm" data-primary="Arduino microcontrollers" data-secondary="selecting in IDE" data-startref="ardmicro-selecting" id="idm45018720192296"/><a data-type="indexterm" data-primary="Arduino IDE" data-secondary="selecting microcontrollers in" data-startref="ardIDE-select" id="idm45018720191032"/><a data-type="indexterm" data-primary="selecting microcontrollers in IDE" data-startref="select-microcontroller" id="idm45018720189800"/> is top-notch 
<span class="keep-together">as well</span>.</p>
</div>
</div></section>













<section data-type="sect2" class="pagebreak-before less_space" data-pdf-bookmark="Hello, LED!"><div class="sect2" id="smallerc-CHP-8-SECT-2.2">
<h2>Hello, LED!</h2>

<p>In <a data-type="indexterm" data-primary="Arduino IDE" data-secondary="&quot;Hello, LED!&quot; program" data-secondary-sortas="Hello, LED" id="ardIDE-hello"/><a data-type="indexterm" data-primary="&quot;Hello, LED!&quot; program" data-primary-sortas="Hello, LED" id="hello-LED"/><a data-type="indexterm" data-primary="LED lights" data-secondary="&quot;Hello, LED!&quot; program" data-secondary-sortas="Hello, LED" id="LED-hello"/><a data-type="indexterm" data-primary="Arduino microcontrollers" data-secondary="LED lights" data-see="LED lights" id="idm45018720181288"/>Arduinoland, making an LED blink is the electronics equivalent of our “Hello, World” program from <a data-type="xref" href="ch01.xhtml#smallerc-CHP-1-SECT-2.2">“Creating a C ‘Hello, World’”</a>. We’ll do our best to lay out any circuitry and connections we build, but you’ll have to adjust as needed for your own controller and components.</p>

<p>Many development boards include an LED with an appropriate resistor right on the board itself.
We’ll start by blinking the LED on our Metro Mini to make sure our C code can be uploaded
and then run on our microcontroller. Back in the Arduino IDE, select the File → New
option. You should now have a <a data-type="indexterm" data-primary="sketches" id="idm45018720177912"/>new <em>sketch</em> tab. “Sketch” is the term for the
compiled bundle meant for executing on a microcontroller.
(More on sketches in <a data-type="xref" href="#smallerc-CHP-8-SECT-4.1">“C++ Objects and Variables”</a>.)
You’ll see two empty functions, <code>setup()</code> and <code>loop()</code>. These two
functions serve as the microcontroller version of the <code>main()</code> function from our desktop C
programs.</p>

<p>The <code>setup()</code> function<a data-type="indexterm" data-primary="setup() function" id="idm45018720173624"/><a data-type="indexterm" data-primary="functions" data-secondary="setup()" id="idm45018720172888"/> is the entry point for our code and is run once, typically
when power is first supplied to the board or after the user presses a reset button (if such
a button is part of the board). Here we set up any global information we need or run any
initializations that are required of our hardware such as resetting a servo position or specifying
how we plan to use the I/O pins.</p>

<p>The <code>loop()</code> function <a data-type="indexterm" data-primary="loop() function" id="idm45018720170600"/><a data-type="indexterm" data-primary="functions" data-secondary="loop()" id="idm45018720169864"/>then takes over to repeat your program indefinitely. Microcontrollers
are typically used to do one task (or perhaps a modest few) over and over as long as they have
power. They can continuously read a sensor. They can drive an LED animation. They can read a
sensor and use that value to alter an LED animation. They can nudge a clock hand forward. But
they all repeat some flow or other until you cut the power, so <code>loop()</code> is an aptly named function.</p>

<p>While there is a lot more going on behind the scenes, it’s reasonable to imagine the
standard <code>main()</code> function for Arduino projects defined like this:</p>

<pre data-type="programlisting" data-code-language="c"><code class="kt">int</code> <code class="nf">main</code><code class="p">()</code> <code class="p">{</code>
  <code class="n">setup</code><code class="p">();</code>
  <code class="k">while</code> <code class="p">(</code><code class="mi">1</code><code class="p">)</code> <code class="p">{</code>
    <code class="n">loop</code><code class="p">();</code>
  <code class="p">}</code>
<code class="p">}</code></pre>

<p>Note that our <code>while</code> loop “condition” is just the value 1. Recall that “not
zero” is considered to be true in these Boolean contexts. So this <code>while</code> loop runs
forever. Just what we need for Arduino.</p>

<p>For our blinking hello program, we’ll use <code>setup()</code> to tell our board we want to use the
built-in LED for output (meaning we’ll “write” on and off values to the pin associated
with the LED). Then we’ll use <code>loop()</code> to do that writing along with some small delays to
make the blinking readily visible to humans. Here’s our first iteration
using constants described in the
<a href="https://oreil.ly/Qt6DM">Arduino docs</a>:</p>

<pre data-type="programlisting" data-code-language="c"><code class="kt">void</code> <code class="nf">setup</code><code class="p">()</code> <code class="p">{</code>
  <code class="c1">// put your setup code here, to run once:</code>
  <code class="c1">// Tell our board we want to write to the built-in LED</code>
  <code class="n">pinMode</code><code class="p">(</code><code class="n">LED_BUILTIN</code><code class="p">,</code> <code class="n">OUTPUT</code><code class="p">);</code>
<code class="p">}</code>

<code class="kt">void</code> <code class="nf">loop</code><code class="p">()</code> <code class="p">{</code>
  <code class="c1">// put your main code here, to run repeatedly:</code>
  <code class="c1">// A high value is 'on' for an LED</code>
  <code class="n">digitalWrite</code><code class="p">(</code><code class="n">LED_BUILTIN</code><code class="p">,</code> <code class="n">HIGH</code><code class="p">);</code>
  <code class="c1">// Now wait for 500 milliseconds</code>
  <code class="n">delay</code><code class="p">(</code><code class="mi">500</code><code class="p">);</code>
  <code class="c1">// And write a low value to turn our LED off</code>
  <code class="n">digitalWrite</code><code class="p">(</code><code class="n">LED_BUILTIN</code><code class="p">,</code> <code class="n">LOW</code><code class="p">);</code>
  <code class="c1">// and wait another 500ms</code>
  <code class="n">delay</code><code class="p">(</code><code class="mi">500</code><code class="p">);</code>
<code class="p">}</code></pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>The all-caps names like <code>LED_BUILTIN</code> and <code>HIGH</code> were defined in headers that are <a data-type="indexterm" data-primary="preprocessor macros" data-secondary="purpose of" id="idm45018720066568"/>included automatically by the Arduino IDE. They are technically preprocessor macros, and we’ll look at those in more detail in <a data-type="xref" href="ch11.xhtml#smallerc-CHP-11-SECT-1.1">“Preprocessor Directives”</a>. They are quite handy and very easy to use in your own code: <code>#define PIN 5</code> defines the word <code>PIN</code> to be the value 5. It’s a lot like a variable or a constant. The difference is that the preprocessor will go through your code before the compiler (hence the “pre-” prefix) and replace every spot it finds <code>PIN</code> with the literal number <code>5</code>. A typical variable or constant would reserve a slot in memory and could be initialized at runtime, perhaps after you have gathered some necessary information from the user.</p>
</div>

<p>Go ahead and type this simple program in. You can also open the
<a href="https://oreil.ly/p6eGd"><em>ch08/blink1/blink1.ino</em></a> project
directly in the IDE.</p>

<p>Before trying<a data-type="indexterm" data-primary="Arduino IDE" data-secondary="verifying code" id="idm45018720060824"/><a data-type="indexterm" data-primary="verifying Arduino IDE code" id="idm45018720059816"/> it on your board, you can use
the IDE’s Verify button (shown in <a data-type="xref" href="#smallerc-CHP-8-FIG-verify-message">Figure 8-8</a>)
to make sure the code compiles.
Verifying your code also checks to make sure your finished program will fit on the
controller you selected. If you have used too many variables or simply have too much
logic, you’ll see warnings and errors in the bottom status area. Try leaving off a
semicolon on some statement like we did in <a data-type="xref" href="ch02.xhtml#smallerc-CHP-2-SECT-1">“Statements in C”</a>. Click Verify
again and you can see the type of message you might encounter as you write your own
code going forward.</p>

<figure><div id="smallerc-CHP-8-FIG-verify-message" class="figure">
<img src="Images/smac_0808.png" alt="smac 0808" width="1440" height="924"/>
<h6><span class="label">Figure 8-8. </span>Verifying your sketch before uploading</h6>
</div></figure>

<p>After<a data-type="indexterm" data-primary="Arduino microcontrollers" data-secondary="uploading code to" id="idm45018720054488"/><a data-type="indexterm" data-primary="uploading code to Arduino microcontrollers" id="idm45018720053416"/> verifying your code is OK, you can ship it over to your microcontroller using
the Upload shortcut button next to Verify or select the appropriate item from
the Sketch menu. Uploading will compile the code (even if you have recently verified
it) and then write it to your board. The Arduino IDE works great with the Metro Mini
on this step—it’s all delightfully automatic. Some development boards need to be
manually configured for upload. Again, the <a href="https://oreil.ly/csLX6">Arduino Help Center</a>
is your friend here.</p>

<p>Once the upload completes, you should see your LED start blinking at half-second intervals.
While less impressive on the printed page, <a data-type="xref" href="#smallerc-CHP-8-FIG-internal-on-off">Figure 8-9</a> shows the on/off
states of our <a data-type="indexterm" data-primary="Arduino IDE" data-secondary="&quot;Hello, LED!&quot; program" data-secondary-sortas="Hello, LED" data-startref="ardIDE-hello" id="idm45018720050024"/><a data-type="indexterm" data-primary="&quot;Hello, LED!&quot; program" data-primary-sortas="Hello, LED" data-startref="hello-LED" id="idm45018720048536"/><a data-type="indexterm" data-primary="LED lights" data-secondary="&quot;Hello, LED!&quot; program" data-secondary-sortas="Hello, LED" data-startref="LED-hello" id="idm45018720047320"/>nifty LED.</p>

<figure><div id="smallerc-CHP-8-FIG-internal-on-off" class="figure">
<img src="Images/smac_0809.png" alt="smac 0809" width="3767" height="1081"/>
<h6><span class="label">Figure 8-9. </span>Our “Hello, World” LED blinking</h6>
</div></figure>
</div></section>













<section data-type="sect2" data-pdf-bookmark="An External LED Upgrade"><div class="sect2" id="smallerc-CHP-8-SECT-2.3">
<h2>An External LED Upgrade</h2>

<p>We<a data-type="indexterm" data-primary="LED lights" data-secondary="external" id="LED-external"/><a data-type="indexterm" data-primary="external LED lights" id="external-LED"/> are focusing on the software side of Arduino projects, but it is impossible to work
with an Arduino and not use <em>some</em> external components. Let’s upgrade our simple blinker
to use an external LED.</p>

<p><a data-type="xref" href="#smallerc-CHP-8-FIG-external-led">Figure 8-10</a> shows the simple circuit we’re using. We have
our controller, one LED, and a resistor. For this setup, we can rely on the power
being supplied over USB.</p>

<figure><div id="smallerc-CHP-8-FIG-external-led" class="figure">
<img src="Images/smac_0810.png" alt="smac 0810" width="890" height="633"/>
<h6><span class="label">Figure 8-10. </span>Simple circuit for an external LED</h6>
</div></figure>

<p>We can pick a pin to use and learn more about the voltage supplied over the
pins by reading the specs for our microcontroller. In the case of our Metro Mini, we
looked at the <a href="https://oreil.ly/H2wNN">Pinouts page</a> on
the Adafruit site. The details tell us which pins on our board map to the UNO’s pins.
Along the “top” of our board (the tiny print on the chip is right side up) are several digital I/O pins, and in particular, pins 2 through 12 are exactly what we need. We’ll start with 2, since it’s such a nice number. Different boards will likely have different configurations, but for ours, pins 0 through 13 map directly to digital pins 0 through 13. So we can either use our own <code>#define</code> and attach a nice name (yay!) or just use the value <code>2</code> in our <code>pinMode()</code> and <code>digitalWrite()</code> calls.</p>

<p>The Metro Mini provides 5V on its digital pins. Using the specs provided by the LED
manufacturer, we know our blue LED has a forward voltage drop of 2.5V. If we want to
supply 30mA of current for a bright light,
<a href="https://oreil.ly/6ihdc">Ohm’s law</a> tells us a 100Ω resistor
will work fine. With everything wired up, we can make a new sketch (or just tweak the first one).
Here’s <a href="https://oreil.ly/xpo2a"><em>ch08/blink2/blink2.ino</em></a>
as it stands:</p>

<pre data-type="programlisting" data-code-language="c"><code class="cp">#define D2 2</code>

<code class="kt">void</code> <code class="nf">setup</code><code class="p">()</code> <code class="p">{</code>
  <code class="c1">// put your setup code here, to run once:</code>
  <code class="c1">// Tell our board we want to write to digital pin 2</code>
  <code class="n">pinMode</code><code class="p">(</code><code class="n">D2</code><code class="p">,</code> <code class="n">OUTPUT</code><code class="p">);</code>
<code class="p">}</code>

<code class="kt">void</code> <code class="nf">loop</code><code class="p">()</code> <code class="p">{</code>
  <code class="n">digitalWrite</code><code class="p">(</code><code class="n">D2</code><code class="p">,</code> <code class="n">HIGH</code><code class="p">);</code>
  <code class="n">delay</code><code class="p">(</code><code class="mi">2000</code><code class="p">);</code>
  <code class="n">digitalWrite</code><code class="p">(</code><code class="n">D2</code><code class="p">,</code> <code class="n">LOW</code><code class="p">);</code>
  <code class="n">delay</code><code class="p">(</code><code class="mi">1000</code><code class="p">);</code>
<code class="p">}</code></pre>

<p>Notice I went with the preprocessor <code>#define</code> feature to designate which digital pin we
are using with our LED (<code>D2</code>). You can see this simple configuration up and running in
<a data-type="xref" href="#smallerc-CHP-8-FIG-external-on-off">Figure 8-11</a>. Hooray!</p>

<figure><div id="smallerc-CHP-8-FIG-external-on-off" class="figure">
<img src="Images/smac_0811.png" alt="smac 0811" width="7496" height="2436"/>
<h6><span class="label">Figure 8-11. </span>Our external LED blinking</h6>
</div></figure>

<p>There is something extra satisfying in these small, physical projects. The “Hello, World” programs are all designed to prove your development environment works and that you can produce some output. That’s all we’ve done here, but gosh it’s fun seeing the LED light turn on. Every time I throw the switch on a new project, it feels a bit like Dr. Frankenstein <a data-type="indexterm" data-primary="LED lights" data-secondary="external" data-startref="LED-external" id="idm45018719967160"/><a data-type="indexterm" data-primary="external LED lights" data-startref="external-LED" id="idm45018719965912"/>screaming, “It’s alive!” in his lab. :-)</p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Arduino Libraries"><div class="sect1" id="smallerc-CHP-8-SECT-3">
<h1>Arduino Libraries</h1>

<p>We’re <a data-type="indexterm" data-primary="Arduino IDE" data-secondary="libraries" data-tertiary="purpose of" id="idm45018719963032"/><a data-type="indexterm" data-primary="libraries" data-secondary="Arduino" data-tertiary="purpose of" id="idm45018719961752"/>not done making blinking lights just yet. While you can do an amazing amount of
work with these microcontrollers right out of the box, quite often you’ll be building
projects with some interesting accessories like multicolor LEDs, LCD screens, 
<span class="keep-together">e-ink</span>,
sensors, servos, keypads, or even game controllers. Many of those components have handy
chunks of code already written for them. These chunks are collected into a library
that you can add to the Arduino IDE. Some of the libraries are “official” and come from
the component maker; others are produced by fellow hobbyists. Whatever the provenance,
libraries can speed up devlopment on your projects.</p>

<p>Let’s take a look at finding and managing libraraies through the IDE. Doing so
properly will help ensure your sketch does not contain any unused libraries.</p>








<section data-type="sect2" data-pdf-bookmark="Managing Libraries"><div class="sect2" id="smallerc-CHP-8-SECT-3.1">
<h2>Managing Libraries</h2>

<p>The<a data-type="indexterm" data-primary="Arduino IDE" data-secondary="libraries" data-tertiary="managing" id="ardIDE-library-manage"/><a data-type="indexterm" data-primary="libraries" data-secondary="Arduino" data-tertiary="managing" id="libraries-arduino-manage"/><a data-type="indexterm" data-primary="LED lights" data-secondary="libraries, managing" id="LED-library-manage"/> Tools menu of the Arduino IDE has an entry to “Manage Libraries…” that pulls up a
dialog for searching and installing libraries. We’re going to add an Adafruit library and try
lighting up one of their fantastic NeoPixels—individually addressable, three-color
LEDs that come in a wide variety of form factors for just about any possible use. They
can even be chained together to build fancier rigs. For this example, though, we’ll
be sticking with one of the simplest form factors: the <a href="https://oreil.ly/JEuFF">Flora</a>.</p>

<p>In the Library Manager dialog, enter the term “neopixel” in the search box at the top.
You should get several results; we want the simple “Adafruit NeoPixel” entry. Click
the Install button (or Update if you happen to have an older version of this
library already installed as we do in <a data-type="xref" href="#smallerc-CHP-8-FIG-neopixel-library">Figure 8-12</a>), and that’s it!
The IDE downloads the library and does the appropriate work to make it available behind the scenes.</p>

<figure><div id="smallerc-CHP-8-FIG-neopixel-library" class="figure">
<img src="Images/smac_0812.png" alt="smac 0812" width="1128" height="634"/>
<h6><span class="label">Figure 8-12. </span>Finding a NeoPixel library</h6>
</div></figure>

<p>The physical circuit for using NeoPixels is similar to what we use for simple LEDs, but
they have three wires rather than two. You have standard <code>V</code>+ and <code>Ground</code> connectors for
the basic power needs, and the third wire provides the “data” to the pixel or strip.
The data does flow in a particular direction, so if you decide to try this circuit, pay
attention to where you connect the data input. Like our simple LED, we also want a small
resistor (470Ω in our case) before the data signal gets to the NeoPixel. You can
see the full setup in <a data-type="xref" href="#smallerc-CHP-8-FIG-flora-circuit">Figure 8-13</a>.</p>

<figure><div id="smallerc-CHP-8-FIG-flora-circuit" class="figure">
<img src="Images/smac_0813.png" alt="smac 0813" width="1091" height="633"/>
<h6><span class="label">Figure 8-13. </span>A simple NeoPixel setup</h6>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>You can follow along with this project without NeoPixels, by the way. You can use any other
addressable LEDs. If you have some of your own WS281x or APA102 or other lights, they’ll
likely work with the excellent <a href="http://fastled.io">FastLED</a> library. You’ll have to do a little
more independent reading, but all of the concepts are the same. FastLED has nice documentation
on GitHub. For example, the work we’ll do in the next section with NeoPixels
is covered<a data-type="indexterm" data-primary="Arduino IDE" data-secondary="libraries" data-tertiary="managing" data-startref="ardIDE-library-manage" id="idm45018719940360"/><a data-type="indexterm" data-primary="libraries" data-secondary="Arduino" data-tertiary="managing" data-startref="libraries-arduino-manage" id="idm45018719938840"/><a data-type="indexterm" data-primary="LED lights" data-secondary="libraries, managing" data-startref="LED-library-manage" id="idm45018719937336"/> in FastLED’s <a href="https://oreil.ly/eupDp">Basic Usage</a> page.</p>
</div>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Using Arduino Libraries"><div class="sect2" id="smallerc-CHP-8-SECT-3.2">
<h2>Using Arduino Libraries</h2>

<p>So how<a data-type="indexterm" data-primary="Arduino IDE" data-secondary="libraries" data-tertiary="installing" id="ardIDE-library-install"/><a data-type="indexterm" data-primary="libraries" data-secondary="Arduino" data-tertiary="installing" id="libraries-arduino-install"/><a data-type="indexterm" data-primary="installing" data-secondary="Arduino libraries" id="install-arduino-library"/> do we pull an Arduino library into our sketch? We use the familiar <code>#include</code>
preprocessor command just like we did with the various header files from the C standard
library in previous chapters. For the NeoPixels, our include looks like this:</p>

<pre data-type="programlisting" data-code-language="c"><code class="cp">#include &lt;Adafruit_NeoPixel.h&gt;</code></pre>

<p>The IDE even helps confirm you have the library installed by bolding and coloring the
name of the header file. Take a look at the comparison
in <a data-type="xref" href="#smallerc-CHP-8-FIG-library-good-bad">Figure 8-14</a> where we used a lower-case “p” when spelling NeoPixel.
The nice, bold color disappears. So if your library is correctly installed and the name stands
out in your include line, you are ready to go!</p>

<figure><div id="smallerc-CHP-8-FIG-library-good-bad" class="figure">
<img src="Images/smac_0814.png" alt="smac 0814" width="1040" height="343"/>
<h6><span class="label">Figure 8-14. </span>Noticing library name mistakes</h6>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>You can use multiple libraries within any given sketch. It’s entirely
reasonable to have a library for things like your LEDs as well as one for servos or for
an LCD screen. The only real limitation is memory—a ubiquitous concern when working
with microcontrollers.</p>
</div>

<p>When you verify a sketch, check the messages in the lower section of the IDE. You’ll get a
report on the memory used as well as how much remains (assuming you have the correct board
selected.) Happily, most folks and companies writing libraries for Arduino are very aware of
how limited <a data-type="indexterm" data-primary="memory" data-secondary="in Arduino" data-tertiary="for libraries" data-secondary-sortas="Arduino" data-tertiary-sortas="libraries" id="idm45018719892520"/>memory is. For example, adding this NeoPixel library took our blinking sketch from
a little under 1K (964 bytes) to about 2.5K (2636 bytes). While you could say it tripled the
amount of flash required to store, getting all of the niceties of the library for less than
2K seems a <a data-type="indexterm" data-primary="Arduino IDE" data-secondary="libraries" data-tertiary="installing" data-startref="ardIDE-library-install" id="idm45018719889400"/><a data-type="indexterm" data-primary="libraries" data-secondary="Arduino" data-tertiary="installing" data-startref="libraries-arduino-install" id="idm45018719887912"/><a data-type="indexterm" data-primary="installing" data-secondary="Arduino libraries" data-startref="install-arduino-library" id="idm45018719886360"/>fair trade-off!</p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Arduino Sketches and C++"><div class="sect1" id="smallerc-CHP-8-SECT-4">
<h1>Arduino Sketches and <span class="keep-together">C++</span></h1>

<p>To<a contenteditable="false" data-primary="sketches" data-secondary="C++ and" data-type="indexterm" id="sketch-cplusplus"/> <a contenteditable="false" data-primary="LED lights" data-secondary="C++ constructors and methods" data-type="indexterm" id="LED-cplusplus"/>put <a contenteditable="false" data-primary="C++" data-secondary="sketches and" data-type="indexterm" id="cplusplus-sketches"/>this NeoPixel library to use, we need to take a tiny detour into <span class="keep-together">C++</span>, a successor to
C with an object orientation (compared to C’s procedural orientation). Sketches are actually
<span class="keep-together">C++</span> projects. Happily, since <span class="keep-together">C++</span> grew out of C, C code is legal <span class="keep-together">C++</span> code as well. As
programmers, we don’t have to learn much <span class="keep-together">C++</span> if we don’t want to.</p>

<p>But notice that “much” qualifier in that last sentence. Many libraries—including our
NeoPixel library—are written as <span class="keep-together">C++</span> classes<a contenteditable="false" data-primary="classes (C++)" data-type="indexterm" id="idm45018719851272"/> (a <em>class</em> is the organizing unit of
object-oriented languages.) These libraries often take advantage of some nifty features of
<span class="keep-together">C++</span>. In particular, you’ll<a contenteditable="false" data-primary="constructors (C++)" data-type="indexterm" id="constructors"/> find <em>constructors</em> and <em>methods</em> used <a contenteditable="false" data-primary="methods (C++)" data-type="indexterm" id="methods"/>all over the place.

<span class="keep-together">Constructors</span> are functions that initialize <a contenteditable="false" data-primary="objects (C++)" data-type="indexterm" id="idm45018719844040"/>an <em>object</em>. An object, in turn, is an encapsulation
of both data and functions meant to access and manipulate that data. Those functions defined
for an object are referred to as the object’s methods.</p>

<p>To see where constructors and methods show up in an Arduino library, let’s go ahead and
finish our next iteration of the blinking light. Recall the setup shown in <a data-type="xref" href="#smallerc-CHP-8-FIG-flora-circuit">Figure 8-13</a>.
We can write a new sketch, <em>blink3</em>, that cycles the NeoPixel through its primary colors: red,
green, and blue. Here’s the full code, including (no pun intended!) the appropriate <code>#include</code> line,
<a href="https://oreil.ly/Ughez"><em>ch08/blink3/blink3.ino</em></a>:</p>

<pre data-type="programlisting" data-code-language="c"><code class="cp">#</code><code class="cp">include &lt;Adafruit_NeoPixel.h&gt;</code><code class="cp">
</code><code>
</code><code class="cp">#</code><code class="cp">define PIXEL_PIN   4</code><code class="cp">
</code><code class="cp">#</code><code class="cp">define PIXEL_COUNT 1</code><code class="cp">
</code><code>
</code><code class="c1">// Declare our NeoPixel strip object per documentation from Adafruit
</code><code class="c1">// https://learn.adafruit.com/adafruit-neopixel-uberguide/arduino-library-use
</code><code>
</code><code class="n">Adafruit_NeoPixel</code><code> </code><code class="nf">strip</code><code class="p">(</code><code class="n">PIXEL_COUNT</code><code class="p">,</code><code> </code><code class="n">PIXEL_PIN</code><code class="p">)</code><code class="p">;</code><code>            </code><a class="co" id="co_real_world_c_with_arduino_CO1-1" href="#callout_real_world_c_with_arduino_CO1-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>

</code><code class="kt">void</code><code> </code><code class="nf">setup</code><code class="p">(</code><code class="p">)</code><code> </code><code class="p">{</code><code>
</code><code>  </code><code class="n">strip</code><code class="p">.</code><code class="n">begin</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>            </code><code class="c1">// Get things ready             </code><a class="co" id="co_real_world_c_with_arduino_CO1-2" href="#callout_real_world_c_with_arduino_CO1-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code class="c1">
</code><code>  </code><code class="n">strip</code><code class="p">.</code><code class="n">setBrightness</code><code class="p">(</code><code class="mi">128</code><code class="p">)</code><code class="p">;</code><code> </code><code class="c1">// Set a comfortable brightness </code><a class="co" id="co_real_world_c_with_arduino_CO1-3" href="#callout_real_world_c_with_arduino_CO1-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code class="c1">
</code><code>  </code><code class="n">strip</code><code class="p">.</code><code class="n">show</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>             </code><code class="c1">// Start with all pixels off    </code><a class="co" id="co_real_world_c_with_arduino_CO1-4" href="#callout_real_world_c_with_arduino_CO1-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code class="c1">
</code><code class="p">}</code><code>
</code><code>
</code><code class="kt">void</code><code> </code><code class="nf">loop</code><code class="p">(</code><code class="p">)</code><code> </code><code class="p">{</code><code>
</code><code>  </code><code class="c1">// Show red for 1 second on the first pixel (start counting at 0)
</code><code>  </code><code class="n">strip</code><code class="p">.</code><code class="n">setPixelColor</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">255</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">)</code><code class="p">;</code><code> </code><a class="co" id="co_real_world_c_with_arduino_CO1-5" href="#callout_real_world_c_with_arduino_CO1-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a><code>
  </code><code class="n">strip</code><code class="p">.</code><code class="n">show</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>                      </code><a class="co" id="co_real_world_c_with_arduino_CO1-6" href="#callout_real_world_c_with_arduino_CO1-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a><code>
  </code><code class="n">delay</code><code class="p">(</code><code class="mi">1000</code><code class="p">)</code><code class="p">;</code><code>
</code><code>  </code><code class="c1">// Show green for 1 second
</code><code>  </code><code class="n">strip</code><code class="p">.</code><code class="n">setPixelColor</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">255</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">)</code><code class="p">;</code><code>
</code><code>  </code><code class="n">strip</code><code class="p">.</code><code class="n">show</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>
</code><code>  </code><code class="n">delay</code><code class="p">(</code><code class="mi">1000</code><code class="p">)</code><code class="p">;</code><code>
</code><code>  </code><code class="c1">// Show blue for 1 second
</code><code>  </code><code class="n">strip</code><code class="p">.</code><code class="n">setPixelColor</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">255</code><code class="p">)</code><code class="p">;</code><code>
</code><code>  </code><code class="n">strip</code><code class="p">.</code><code class="n">show</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>
</code><code>  </code><code class="n">delay</code><code class="p">(</code><code class="mi">1000</code><code class="p">)</code><code class="p">;</code><code>
</code><code class="p">}</code></pre>
<dl class="calloutlist pagebreak-before">
<dt><a class="co" id="callout_real_world_c_with_arduino_CO1-1" href="#co_real_world_c_with_arduino_CO1-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Our constructed variable, <code>strip</code>. Its class (roughly analagous to its type) is <code>Adafruit_NeoPixel</code>.
The name “strip” here is common, but a little wrong for our single Flora.
But technically we are allocating a strip that is simply one pixel long.</p></dd>
<dt><a class="co" id="callout_real_world_c_with_arduino_CO1-2" href="#co_real_world_c_with_arduino_CO1-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>An example of a method: <code>begin()</code> is a function that applies to <code>strip</code>.
The <code>begin()</code> method gets our strip of lights ready by filling
in default values and performing other miscellaneous startup tasks.</p></dd>
<dt><a class="co" id="callout_real_world_c_with_arduino_CO1-3" href="#co_real_world_c_with_arduino_CO1-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>The <code>setBrightness()</code> method controls a premultiplied max brightness on <code>strip</code>.</p></dd>
<dt><a class="co" id="callout_real_world_c_with_arduino_CO1-4" href="#co_real_world_c_with_arduino_CO1-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>Another example of a method. <code>show()</code> causes the current colors in
memory to be displayed on the actual LEDs of <code>strip</code>.</p></dd>
<dt><a class="co" id="callout_real_world_c_with_arduino_CO1-5" href="#co_real_world_c_with_arduino_CO1-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>The <code>setPixelColor()</code> method takes four arguments: which pixel on <code>strip</code> to
set (starting at 0), and the red, green, and blue values to apply. Color values
range from 0 (off) to 255 (full brightness, though the final value is adjusted
by that <code>setBrightness()</code> call we made in <code>setup()</code>).</p></dd>
<dt><a class="co" id="callout_real_world_c_with_arduino_CO1-6" href="#co_real_world_c_with_arduino_CO1-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>To see our new pixel color on <code>strip</code>, we repeat our call to <code>show()</code>.</p></dd>
</dl>

<p>Try uploading this with your NeoPixel connected. Hopefully, you’ll see it run through red, green, and blue colors, as shown in <a data-type="xref" href="#smallerc-CHP-8-FIG-flora-rgb">Figure 8-15</a>.</p>

<figure><div id="smallerc-CHP-8-FIG-flora-rgb" class="figure">
<img src="Images/smac_0815.png" alt="smac 0815" width="9520" height="2963"/>
<h6><span class="label">Figure 8-15. </span>Our blinking NeoPixel</h6>
</div></figure>

<p>Neat! <a contenteditable="false" data-primary="sketches" data-secondary="C++ and" data-type="indexterm" data-startref="sketch-cplusplus" id="idm45018719600872"/>Feel <a contenteditable="false" data-primary="LED lights" data-secondary="C++ constructors and methods" data-type="indexterm" data-startref="LED-cplusplus" id="idm45018719599288"/>free to play around with the color or blink patterns. It <a contenteditable="false" data-primary="C++" data-secondary="sketches and" data-type="indexterm" data-startref="cplusplus-sketches" id="idm45018719597704"/>can <a contenteditable="false" data-primary="constructors (C++)" data-type="indexterm" data-startref="constructors" id="idm45018719596120"/>be
surprisingly <a contenteditable="false" data-primary="methods (C++)" data-type="indexterm" data-startref="methods" id="idm45018719594776"/>fun getting just the right hue. It really is magic. And now,
you too know the right incantations!</p>








<section data-type="sect2" data-pdf-bookmark="C++ Objects and Variables"><div class="sect2" id="smallerc-CHP-8-SECT-4.1">
<h2><span class="keep-together">C++</span> Objects and Variables</h2>

<p>When <a contenteditable="false" data-primary="objects (C++)" data-secondary="creating" data-type="indexterm" id="objects-create"/>you <a contenteditable="false" data-primary="variables" data-secondary="C++ objects and" data-type="indexterm" id="variables-cplus-plus-objects"/>create<a contenteditable="false" data-primary="C++" data-secondary="objects" data-tertiary="creating" data-type="indexterm" id="cplusplus-objects-create"/> an object <a contenteditable="false" data-primary="methods (C++)" data-secondary="calling" data-type="indexterm" id="methods-calling"/>variable, <a contenteditable="false" data-primary="calling" data-secondary="methods (C++)" data-type="indexterm" id="calling-methods"/>the declaration and initialization look
a little funny. In C,  we can create a variable and give it some starting value
like this:</p>

<pre data-type="programlisting" data-code-language="c"><code class="kt">int</code> <code class="n">counter</code> <code class="o">=</code> <code class="mi">1</code><code class="p">;</code></pre>

<p>If we had a <span class="keep-together">C++</span> class named <code>Integer</code>, trying the same type of setup might
look like this:</p>

<pre data-type="programlisting" data-code-language="c"><code class="n">Integer</code> <code class="nf">counter</code><code class="p">(</code><code class="mi">1</code><code class="p">);</code></pre>

<p>The parentheses give you a clue that <a contenteditable="false" data-primary="functions" data-secondary="constructors and" data-type="indexterm" id="idm45018719559800"/>a function is being called. That’s the
constructor. If you decide to go on and study <span class="keep-together">C++</span> down the road, you’ll learn
all the clever things that can be done in constructors. For now, though, we just
want you to be aware of the syntax so that you’re comfortable creating variables
that refer to objects.</p>

<p>The <code>strip.begin()</code> and <code>strip.setPixelColor()</code> lines that we called out are
examples of calling an object’s functions (again, object-oriented languages
use the term “methods”). The idea is the <code>strip</code> is what we want to work on,
and <code>begin()</code> or <code>setPixelColor()</code> represents the work to be done.</p>

<p>One way to
think about this syntax is that it is a sort of transformation. In pure C,
we could imagine writing normal functions for <code>begin()</code> and <code>setPixelColor()</code>.
But we’d have to tell those functions which strip of NeoPixels we want to
set up or change. So we would need an extra argument to pass a reference
to the correct strip like so:</p>

<pre data-type="programlisting" data-code-language="c"><code class="kt">void</code> <code class="nf">setup</code><code class="p">()</code> <code class="p">{</code>
  <code class="n">begin</code><code class="p">(</code><code class="o">&amp;</code><code class="n">strip</code><code class="p">);</code>
  <code class="c1">// ...</code>
<code class="p">}</code>

<code class="kt">void</code> <code class="nf">loop</code><code class="p">()</code> <code class="p">{</code>
  <code class="c1">// ...</code>
  <code class="n">setPixelColor</code><code class="p">(</code><code class="o">&amp;</code><code class="n">strip</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">255</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">);</code>
<code class="p">}</code></pre>

<p>But again, for our work in this book, you mostly just need to get comfortable
with statements that create a new object from a library, and then remember
that using the methods of objects follows the <code>object.method()</code> pattern.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="smallerc-CHP-8-SIDEBAR-1">
<h5>What Are <em>.ino</em> Files?</h5>
<p>If you<a contenteditable="false" data-primary=".ino files" data-primary-sortas="ino files" data-type="indexterm" id="idm45018719484600"/> look in your <a contenteditable="false" data-primary="Arduino IDE" data-secondary=".ino files" data-secondary-sortas="ino files" data-type="indexterm" id="idm45018719482680"/>computer’s filesystem for the files being saved from the
Arduino IDE, you’ll discover there are folders matching the sketch names
(e.g., <em>blink1</em>, <em>blink2</em>, etc.). Inside each folder is a <em>.ino</em> file with
the same base name as the sketch as well. But what are <em>.ino</em> files? They are
actually rebranded <span class="keep-together">C++</span> files. (Do you see the suffix from A-r-d-u-<strong><em>ino</em></strong>?)
To compile a valid application, you still need a
 <code>main()</code> function as a launch point. The IDE is doing some magic behind the
scenes to incorporate our <em>.ino</em> content into a broader package that has a
few standard includes and an appropriate <code>main()</code> function. That function will
“do the right thing” to get our Arduino code up and running. It will call
 <code>setup()</code> at the start, then move on and call <code>loop()</code> inside, well, a
loop.</p>

<p>For our projects, we don’t really need to worry about these files. The IDE
manages them for us. We will be looking at writing more complex projects and
creating our own libraries in <a data-type="xref" href="ch11.xhtml#smallerc-CHP-11">Chapter 11</a>, but the majority of our projects
will fit in the standard <code>setup()</code> and <code>loop()</code> functions of a single file.
I do want you to be aware of where things are stored so that you are familiar
with the structure of these Arduino projects. That familiarity can be useful
when you get advanced enough that single-file projects no longer cover your
needs.</p>
</div></aside>
</div></section>













<section data-type="sect2" data-pdf-bookmark="More Practice with Objects"><div class="sect2" id="smallerc-CHP-8-SECT-4.2">
<h2>More Practice with Objects</h2>

<p>Before<a contenteditable="false" data-primary="LED lights" data-secondary="C++ objects" data-type="indexterm" id="LED-objects"/> we move <a contenteditable="false" data-primary="objects (C++)" data-secondary="LED lights and" data-type="indexterm" id="objects-LED"/>on to <a contenteditable="false" data-primary="C++" data-secondary="objects" data-tertiary="LED lights" data-type="indexterm" id="objects-create-2"/>other aspects of coding for microcontrollers, let’s make
one more blinking application with an eye toward reinforcing the object
syntax. We’ll try using some actual strips of LEDs with more than one
LED. In particular, we’ll be using a small <a href="https://oreil.ly/yeieS">stick</a>
of 8 NeoPixels and a <a href="https://oreil.ly/1CTcw">ring</a>
of 24 NeoPixels. To make things even more fun, we’ll be using them at
the same time!</p>

<p>To keep the code simple, we’ll make a blink program that shows one pixel
at a time on each strip. This will also keep the power requirement down so that
we can continue to use what we get from our USB connection. (If you are familiar
with larger LED setups and already know how to add external power, feel free
to create your own arrangement.) <a data-type="xref" href="#smallerc-CHP-8-FIG-ring-stick">Figure 8-16</a> shows our new setup.
We removed the blue LED and the previous “strip” of the lonely NeoPixel Flora.</p>

<figure class="width-80"><div id="smallerc-CHP-8-FIG-ring-stick" class="figure">
<img src="Images/smac_0816.png" alt="smac 0816" width="1982" height="1020"/>
<h6><span class="label">Figure 8-16. </span>A more interesting NeoPixel setup</h6>
</div></figure>

<p>We are reusing the same output pins for the data line, though. In this arrangement,
the stick is using pin 2 and the ring is using pin 4.</p>

<p>Without further ado, here is the code for our two-strip blink extravaganza, <em>blink4</em>.
We’ll dive into the callouts after the snippet to make sure the steps we take here make
sense. Before reading those callouts, though, try
going through
<a href="https://oreil.ly/19dUL"><em>ch08/blink4/blink4.ino</em></a>
and see if you can guess how the objects work.</p>

<pre data-type="programlisting" data-code-language="c"><code class="cp">#</code><code class="cp">include &lt;Adafruit_NeoPixel.h&gt;</code><code class="cp">
</code><code>
</code><code class="cp">#</code><code class="cp">define STICK_PIN   2</code><code class="cp">
</code><code class="cp">#</code><code class="cp">define STICK_COUNT 8</code><code class="cp">
</code><code class="cp">#</code><code class="cp">define RING_PIN    4</code><code class="cp">
</code><code class="cp">#</code><code class="cp">define RING_COUNT 24</code><code class="cp">
</code><code>
</code><code class="c1">// Declare our NeoPixel strip object per documentation from Adafruit
</code><code class="c1">// https://learn.adafruit.com/adafruit-neopixel-uberguide/arduino-library-use
</code><code>
</code><code class="n">Adafruit_NeoPixel</code><code> </code><code class="nf">stick</code><code class="p">(</code><code class="n">STICK_COUNT</code><code class="p">,</code><code> </code><code class="n">STICK_PIN</code><code class="p">)</code><code class="p">;</code><code>        </code><a class="co" id="co_real_world_c_with_arduino_CO2-1" href="#callout_real_world_c_with_arduino_CO2-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code class="n">Adafruit_NeoPixel</code><code> </code><code class="nf">ring</code><code class="p">(</code><code class="n">RING_COUNT</code><code class="p">,</code><code> </code><code class="n">RING_PIN</code><code class="p">,</code><code> </code><code class="n">NEO_GRBW</code><code class="p">)</code><code class="p">;</code><code> </code><a class="co" id="co_real_world_c_with_arduino_CO2-2" href="#callout_real_world_c_with_arduino_CO2-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>

</code><code class="kt">void</code><code> </code><code class="nf">setup</code><code class="p">(</code><code class="p">)</code><code> </code><code class="p">{</code><code>
</code><code>  </code><code class="n">stick</code><code class="p">.</code><code class="n">begin</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>            </code><code class="c1">// Initialize our stick     </code><a class="co" id="co_real_world_c_with_arduino_CO2-3" href="#callout_real_world_c_with_arduino_CO2-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code class="c1">
</code><code>  </code><code class="n">stick</code><code class="p">.</code><code class="n">setBrightness</code><code class="p">(</code><code class="mi">128</code><code class="p">)</code><code class="p">;</code><code>
</code><code>  </code><code class="n">stick</code><code class="p">.</code><code class="n">show</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>
</code><code>  </code><code class="n">ring</code><code class="p">.</code><code class="n">begin</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>             </code><code class="c1">// Initialize our ring      </code><a class="co" id="co_real_world_c_with_arduino_CO2-4" href="#callout_real_world_c_with_arduino_CO2-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code class="c1">
</code><code>  </code><code class="n">ring</code><code class="p">.</code><code class="n">setBrightness</code><code class="p">(</code><code class="mi">128</code><code class="p">)</code><code class="p">;</code><code>
</code><code>  </code><code class="n">ring</code><code class="p">.</code><code class="n">show</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>
</code><code class="p">}</code><code>
</code><code>
</code><code class="kt">void</code><code> </code><code class="nf">loop</code><code class="p">(</code><code class="p">)</code><code> </code><code class="p">{</code><code>
</code><code>  </code><code class="c1">// our stick and ring have different LED counts, so we have
</code><code>  </code><code class="c1">// to be a little clever with our loop. There are several
</code><code>  </code><code class="c1">// ways to do this. We'll use modulus (remainder) math, but
</code><code>  </code><code class="c1">// can you think of other solutions that would achieve
</code><code>  </code><code class="c1">// the same pattern?
</code><code>  </code><code class="k">for</code><code> </code><code class="p">(</code><code class="kt">int</code><code> </code><code class="n">p</code><code> </code><code class="o">=</code><code> </code><code class="mi">0</code><code class="p">;</code><code> </code><code class="n">p</code><code> </code><code class="o">&lt;</code><code> </code><code class="n">RING_COUNT</code><code class="p">;</code><code> </code><code class="n">p</code><code class="o">+</code><code class="o">+</code><code class="p">)</code><code> </code><code class="p">{</code><code>
</code><code>    </code><code class="n">stick</code><code class="p">.</code><code class="n">clear</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>
</code><code>    </code><code class="n">stick</code><code class="p">.</code><code class="n">setPixelColor</code><code class="p">(</code><code class="n">p</code><code> </code><code class="o">%</code><code> </code><code class="n">STICK_COUNT</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">255</code><code class="p">)</code><code class="p">;</code><code>    </code><a class="co" id="co_real_world_c_with_arduino_CO2-5" href="#callout_real_world_c_with_arduino_CO2-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a><code>
    </code><code class="n">ring</code><code class="p">.</code><code class="n">clear</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>
</code><code>    </code><code class="n">ring</code><code class="p">.</code><code class="n">setPixelColor</code><code class="p">(</code><code class="n">p</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">255</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">)</code><code class="p">;</code><code>                </code><a class="co" id="co_real_world_c_with_arduino_CO2-6" href="#callout_real_world_c_with_arduino_CO2-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a><code>
    </code><code class="n">stick</code><code class="p">.</code><code class="n">show</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>                                       </code><a class="co" id="co_real_world_c_with_arduino_CO2-7" href="#callout_real_world_c_with_arduino_CO2-7"><img src="Images/7.png" alt="7" width="12" height="12"/></a><code>
    </code><code class="n">ring</code><code class="p">.</code><code class="n">show</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>
</code><code>  </code><code class="p">}</code><code>
</code><code class="p">}</code></pre>
<dl class="calloutlist pagebreak-before less_space">
<dt><a class="co" id="callout_real_world_c_with_arduino_CO2-1" href="#co_real_world_c_with_arduino_CO2-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Here we create an Adafruit_NeoPixel object named <code>stick</code> similar to how we created
<code>strip</code> in <a data-type="xref" href="#smallerc-CHP-8-SECT-4">“Arduino Sketches and C++”</a>.</p></dd>
<dt><a class="co" id="callout_real_world_c_with_arduino_CO2-2" href="#co_real_world_c_with_arduino_CO2-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>And now we create a second, distinct object named <code>ring</code>. (The ring uses a
fancier LED configuration with a white component so we add a third argument to the
constructor. You can find this value in the NeoPixel documentation.)</p></dd>
<dt><a class="co" id="callout_real_world_c_with_arduino_CO2-3" href="#co_real_world_c_with_arduino_CO2-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>We initialize our stick just as we did before with the strip.</p></dd>
<dt><a class="co" id="callout_real_world_c_with_arduino_CO2-4" href="#co_real_world_c_with_arduino_CO2-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>We also initialize our ring; notice we use the <code>begin()</code> method on both objects.</p></dd>
<dt><a class="co" id="callout_real_world_c_with_arduino_CO2-5" href="#co_real_world_c_with_arduino_CO2-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>Now we set the color of one of the pixels on our stick.</p></dd>
<dt><a class="co" id="callout_real_world_c_with_arduino_CO2-6" href="#co_real_world_c_with_arduino_CO2-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>We use a similar method with a fifth argument to set the color on our ring.
(The arguments here are which pixel, red, green, blue, and white. The ring will
blink green.)</p></dd>
<dt><a class="co" id="callout_real_world_c_with_arduino_CO2-7" href="#co_real_world_c_with_arduino_CO2-7"><img src="Images/7.png" alt="7" width="12" height="12"/></a></dt>
<dd><p>Last but not least, show both changes.</p></dd>
</dl>

<p>Hopefully, seeing two objects in use side by side helps illustrate how the object-oriented
syntax works. Again, our <code>for</code> loop <a contenteditable="false" data-primary="C++" data-secondary="objects" data-tertiary="LED lights" data-type="indexterm" data-startref="objects-create-2" id="idm45018719304008"/>is pure C. We dip <a contenteditable="false" data-primary="objects (C++)" data-secondary="LED lights and" data-type="indexterm" data-startref="objects-LED" id="idm45018719301928"/>into the <span class="keep-together">C++</span> syntax <a contenteditable="false" data-primary="LED lights" data-secondary="C++ objects" data-type="indexterm" data-startref="LED-objects" id="idm45018719299400"/>on an as-needed
basis.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="C++ Considerations"><div class="sect2" id="smallerc-CHP-8-SECT-4.3">
<h2><span class="keep-together">C++</span> Considerations</h2>

<p>There <a contenteditable="false" data-primary="C++" data-secondary="considerations in Arduino programming" data-type="indexterm" id="cplusplus-considerations"/>is <a contenteditable="false" data-primary="Arduino IDE" data-secondary="C++ considerations" data-type="indexterm" id="ardIDE-cplusplus-considerations"/>definitely <a contenteditable="false" data-primary="object-oriented programming" data-see="C++" data-type="indexterm" id="idm45018719291544"/>more to the role of object-oriented programming in Arduino development.
OO programming is a fairly natural fit for an environment where so many of things we get to work
with are physical objects. <span class="keep-together">C++</span> also offers several features that are well suited to bundling
up code to share with others. If you interact with your microcontrollers primarily through
the Arduino IDE, it’s worth spending some time investigating <span class="keep-together">C++</span>.</p>

<p>Diving into <span class="keep-together">C++</span> will teach you about classes and members and methods. You’ll create
constructors and destructors. As your understanding of objects improves, you’ll likely
start breaking down your projects along object lines rather than along functional ones. You
will certainly find things you like about <span class="keep-together">C++</span> and probably a few that you don’t.
Some libraries will be easier to use if you understand <span class="keep-together">C++</span>, but none of them will be out of
your reach even if you never crack an official <span class="keep-together">C++</span> book.</p>

<p class="pagebreak-before less_space">The C language on its own remains a powerful core in Arduino programming, and I’ll keep
the focus of the remaining chapters on using functions and other basic C features to code up
our projects. Where we use any third-party libraries for specific peripherals, I’ll try
to use the minimum of object notation. I’ll also try to highlight any spots where <span class="keep-together">C++</span>
syntax stands out.</p>

<p>To reiterate the most common object-oriented patterns you’ll see in the remaining
chapters, here is a recap from our NeoPixel example in <a data-type="xref" href="#smallerc-CHP-8-SECT-4">“Arduino Sketches and C++”</a>:</p>

<pre data-type="programlisting" data-code-language="c"><code class="c1">// Using a library written in C++ still requires the same C "#include"</code>
<code class="c1">// directive to bring in the associated header file.</code>
<code class="cp">#include &lt;Adafruit_NeoPixel.h&gt;</code>

<code class="cp">#define PIXEL_PIN   4</code>
<code class="cp">#define PIXEL_COUNT 1</code>

<code class="c1">// Common example of a C++ constructor call that creates an object.</code>
<code class="c1">// Our NeoPixel "strip" is the created object in this case.</code>
<code class="n">Adafruit_NeoPixel</code> <code class="nf">strip</code><code class="p">(</code><code class="n">PIXEL_COUNT</code><code class="p">,</code> <code class="n">PIXEL_PIN</code><code class="p">);</code>

<code class="kt">void</code> <code class="nf">setup</code><code class="p">()</code> <code class="p">{</code>
  <code class="c1">// Common example of using the method "begin()" from our object "strip".</code>
  <code class="n">strip</code><code class="p">.</code><code class="n">begin</code><code class="p">();</code>

<code class="c1">// ...</code></pre>

<p>Hopefully, you’ll grow more comfortable with these small dips into <span class="keep-together">C++</span>. I also hope that comfort grows into curiosity about what more you can do with <span class="keep-together">C++</span>! But don’t worry if you never really get curious or even comfortable. One of the things I most enjoy about coding for microcontrollers is that a little code goes a long way. You can still get a lot of satisfaction out of your programming efforts without mastering <span class="keep-together">C++</span>. A brief scan of my own projects shows that I stuck with C more than 90% of the time, even though every one of those projects also uses a library<a contenteditable="false" data-primary="Arduino IDE" data-secondary="C++ considerations" data-type="indexterm" data-startref="ardIDE-cplusplus-considerations" id="idm45018719116744"/> written <a contenteditable="false" data-primary="C++" data-secondary="considerations in Arduino programming" data-type="indexterm" data-startref="cplusplus-considerations" id="idm45018719106328"/>in <span class="keep-together">C++</span>.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Object Homework"><div class="sect2" id="smallerc-CHP-8-SECT-4.4">
<h2>Object Homework</h2>

<p>If you’d like a little more practice with the object notation we’ve already seen and will bump into occasionally in the coming chapters, try creating some of these ideas:</p>

<ul>
<li>
<p>Blink every other pixel on the stick so that the even pixels turn on, then the odd pixels, back and forth.</p>
</li>
<li>
<p>Blink each pixel on the ring once for every pixel on the stick, like a counter. (I.e., keep one pixel
showing on the stick as you march around the ring. Then move to the next pixel on the stick, and march
around the ring again. Repeat!)</p>
</li>
<li>
<p>Working with just the stick, try “filling” it from left to right. Then clear all the pixels
and let it fill again.</p>
</li>
<li>
<p>Take a look at the documentation for <a href="https://oreil.ly/GxxxI">NeoPixels</a> (or <a href="https://oreil.ly/9Ln6A">FastLED</a>,
or whatever library you are using) and see if
there are any methods to turn the entire strip one color with a single call. Use that method to
turn the entire stick red, then green, then blue, similar to our <em>blink3</em> program that used the single
Flora.</p>
</li>
</ul>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Next Steps"><div class="sect1" id="smallerc-CHP-8-SECT-5">
<h1>Next Steps</h1>

<p>We now have the basics of an Arduino project up and running. We’ve worked with the Arduino
IDE and we’ve seen where <span class="keep-together">C++</span> might crop up in our code. Putting it all together, we turned
on an LED! While that is exciting, there is a lot more fun to 
<span class="keep-together">be had.</span></p>

<p>In the next chapter, we’ll explore some of the
many inputs and outputs available for use with a microcontroller. We certainly can’t cover
every sensor or button or speaker or display, but we can (and will!) look at several good
examples of these peripherals. We’ll concentrate on getting these disparate gadgets to
work together so you have a solid foundation to rely on as you tackle your own projects down
the road.</p>
</div></section>







<div data-type="footnotes"><p data-type="footnote" id="idm45018720330312"><sup><a href="ch08.xhtml#idm45018720330312-marker">1</a></sup> For more (much more!) information on the details of Arduino, check out <a href="https://learning.oreilly.com/library/view/arduino-a-technical/9781491934319/" class="orm:hideurl"><em>Arduino: A Technical Reference</em></a> by  <span class="keep-together">J. M. Hughes</span> (O’Reilly).</p></div></div></section></div></body></html>